<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="member">
	<select id="selectOneMember" parameterType="m" resultType="m">
	select 
		member_no as memberNo,
		biz_no as bizNo,
		biz_name as bizName,
		member_id as memberId,
		member_pw as memberPw,
		member_name as memberName,
		member_phone as memberPhone,
		member_level as memberLevel,
		member_gender as memberGender,
		member_birth as memberBirth,
		member_postcode as memberPostcode,
		member_addr1 as memberAddr1,
		member_addr2 as memberAddr2,
		member_point as memberPoint
	from member where member_id=#{memberId} 
	<if test="memberPw != null">
	 	and member_pw=#{memberPw}
	</if>
	</select>
	<select id="selectMemberList" parameterType="map" resultType="m">
	select 
		member_no as memberNo,
		biz_no as bizNo,
		biz_name as bizName,
		member_id as memberId,
		member_pw as memberPw,
		member_name as memberName,
		member_phone as memberPhone,
		member_level as memberLevel,
		member_gender as memberGender,
		member_birth as memberBirth,
		member_postcode as memberPostcode,
		member_addr1 as memberAddr1,
		member_addr2 as memberAddr2,
		member_point as memberPoint
	from member 
	<choose>
		<when test="memberLevel == 2">
		where member_level=2
		</when>
		<when test="memberLevel == 1">
		where member_level=1
		</when>
	</choose>
	</select>
	<select id="selectMemberCount" parameterType="map" resultType="int">
		select count(*) from member
		<choose>
			<when test="memberLevel == 2">
			where member_level=2
			</when>
			<when test="memberLevel == 1">
			where member_level=1
			</when>
		</choose>
	</select>
  	<insert id="insertMember" parameterType="m">
  		insert into member values (member_seq.nextval,
  		<choose>
  			<when test="#{memberLevel.equals(2)}">
  			null,null
  			</when>
  			<when test="#{memberLevel.equals(1)}">
  			#{bizNo},#{bizName}
  			</when>
  		</choose>
  		,#{memberId},#{memberPw},#{memberName},#{memberPhone},#{memberLevel},#{memberGender},#{memberBirth},#{memberPostcode},#{memberAddr1},#{memberAddr2},3000)
  	</insert>
  	<update id="newPw">
  		update member set member_pw=#{memberPw} where member_id=#{memberId}
  	</update>
  	<delete id="deleteMember" parameterType="String">
  		delete from member where member_id=#{memberId} 
  	</delete>
  	<update id="memberUpdate" parameterType="m">
  		update member set member_name=#{memberName},member_phone=#{memberPhone},member_postcode=#{memberPostcode},member_addr1=#{memberAddr1},member_addr2=#{memberAddr2}
  			where member_id=#{memberId}
  	</update>
</mapper>
