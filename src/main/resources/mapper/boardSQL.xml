<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="board">
  	<select id="selectCommentList" parameterType="map" resultType="bo">
		<if test="#{divNo eq 1}">
		select * from 
			(select rownum as rnum, c.* from 
			(select 
				b.comment_no as commentNo, 
				b.div_no as divNo,
				f.funding_name as projectName,
				b.comment_content as commentContent,
				substr(b.comment_date,1,10) as commentDate
			from comment_tbl b, auction_tbl a, donation d, funding f, group_tbl g 
			where b.member_no=f.member_no
			and b.member_no=#{memberNo} order by comment_no desc)c) 
		where rnum between #{start} and #{end} 
		</if>
		<if test="#{divNo eq 2}">
		select * from 
			(select rownum as rnum, c.* from 
			(select 
				b.comment_no as commentNo, 
				b.div_no as divNo,
				d.donation_title as projectName,
				b.comment_content as commentContent,
				substr(b.comment_date,1,10) as commentDate
			from comment_tbl b, auction_tbl a, donation d, funding f, group_tbl g 
			where b.member_no=d.member_no
		where rnum between #{start} and #{end} 
		</if>
		<if test="#{divNo eq 3}">
		select * from 
		(select rownum as rnum, c.* from 
		(select 
			b.comment_no as commentNo, 
			b.div_no as divNo,
			g.project_name as projectName,
			b.comment_content as commentContent,
			substr(b.comment_date,1,10) as commentDate
		from comment_tbl b, auction_tbl a, donation d, funding f, group_tbl g 
		where b.member_no=g.member_no
			and b.member_no=#{memberNo} order by comment_no desc)c) 
		where rnum between #{start} and #{end}  
		</if>
		<if test="#{divNo eq 4}">
		select * from 
			(select rownum as rnum, c.* from 
			(select 
				b.comment_no as commentNo, 
				b.div_no as divNo,
				a.project_name as projectName,
				b.comment_content as commentContent,
				substr(b.comment_date,1,10) as commentDate
			from comment_tbl b, auction_tbl a, donation d, funding f, group_tbl g 
			where b.member_no=a.member_no
			and b.member_no=#{memberNo} order by comment_no desc)c) 
		where rnum between #{start} and #{end}  	
		</if>	
  	</select>
  	<select id="selectLikeList" parameterType="map" resultType="bo">
		select * from 
		(select rownum as rnum, c.* from 
		(select
			div_no as divNo,
			project_no as projectNo,
			comment_content as commentContent,
			substr(comment_date,1,10) as commentDate,
			comment_no as commentNo
		from like_tbl where member_no=#{memberNo} order by like_no desc)c) 
		where rnum between #{start} and #{end}  		
  	</select>
  	<select id="selectOrderList" parameterType="map" resultType="bo">
		select * from 
		(select rownum as rnum, c.* from 
		(select
			div_no as divNo,
			project_no as projectNo,
			comment_content as commentContent,
			substr(comment_date,1,10) as commentDate,
			comment_no as commentNo
		from order_tbl where member_no=#{memberNo} order by order_no desc)c) 
		where rnum between #{start} and #{end}  		
  	</select>
  	<select id="selectQnaList" parameterType="map" resultType="bo">
		select * from 
		(select rownum as rnum, c.* from 
		(select
			div_no as divNo,
			project_no as projectNo,
			comment_content as commentContent,
			substr(comment_date,1,10) as commentDate,
			comment_no as commentNo
		from qna_tbl where member_no=#{memberNo} order by qna_no desc)c) 
		where rnum between #{start} and #{end}  		
  	</select>
  	<select id="selectCount" parameterType="map" resultType="int">
  		select count(*) from
  		<choose>
  			<when test="#{boardName.equals('comment_tbl')}"> 
  				comment_tbl
  			</when>
  			<when test="#{boardName.equals('like_tbl')}"> 
  				like_tbl
  			</when>
  			<when test="#{boardName.equals('order_tbl')}"> 
  				order_tbl
  			</when>
  			<when test="#{boardName.equals('qna_tbl')}"> 
  				qna_tbl
  			</when>
  		</choose> 
  		where member_no=#{memberNo}
  	</select>
</mapper>
